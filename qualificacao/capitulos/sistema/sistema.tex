\mychapter{Sistema proposto}
\label{cap:sistema}
Existem diversos métodos consolidados para detecção e isolamento de falhas,
sendo alguns deles baseados em redundância física de componentes de hardware,
como sensores, atuadores e controladores. Entretanto, a duplicação de
componentes de hardware nem sempre é possível, uma vez que os custos
relacionados com a adição de novos componentes componente podem elevar o
orçamento do processo demasiadamente.

Devido a esse elevado custo, existe uma fronteira clara e inerente à aplicação
de técnicas de tolerância a falhas. A escolha adequada dos dispositivos físicos
e dos {\it softwares} devem então levar em consideração as exigências
específicas de cada sistema de maneira individual, de tal maneira que se possa
contornar o custo associado ao emprego dessas técnicas \cite{weber:2002}.

Assim sendo, a primeira parte do capítulo descreverá em detalhes o modelo de
estudo de caso escolhido para ser simulado, mostrando suas características e
limitações. Em seguida a atenção será voltada para as estruturas neurais de
identificação do modelo e de detecção das falhas, mostrando ao final como serão
realizadas as simulações.

% ------------------------------------------------------------------------------
\section{Estudo de caso}
Ao final do Cap. \ref{cap:introducao}, após ter-se comentado sobre a utilização
das RNAs em sistemas de DDF, propôs-se que será desenvolvido um sistema para
realizar a detecçao e o diagnóstico de falhas em um processo dinâmico. Para que
isso seja possível serão utilizadas estruturas neurais que farão uso de
determinados valores obtidos a partir das medições realizadas no processo.

O processo em questão, ao qual se refere o parágrafo anterior, é formado por um
sistema de tanques acoplados desenvolvidos pela Quanser\reg, representado
esquematicamente na Fig. \ref{fig:tanques}.

\begin{figure}[htb]
\centering
    \includegraphics[width=0.7\textwidth]{imgs/sistema/eps/tanques}
    \caption{Sistema de tanques acoplados da Quanser\reg.}
    \label{fig:tanques}
\end{figure}

O sistema original consiste de uma bomba de água de corrente contínua e dois
tanques acoplados. A alimentação de água pela bomba se dá de forma vertical
através de dois orifícios com conectores normalmente fechados, de diferentes
diâmetros, denominados {\it Out 1} e {\it Out 2}. Para facilitar o entendimento
e evitar confusões com relação aos orifícios de saída dos tanques ($a_1$ e
$a_2$), esses orifícios serão tratados como orifícios de entrada.

\Glossary{$a_i$}{Orifício de saída $i$}

Os tanques ($T_1$ e $T_2$) são montados na parte frontal do suporte de base e
posicionados de tal forma que a água flui do tanque superior ($T_1$) para o
tanque inferior ($T_2$) através do orifício $a_1$, e do tanque inferior para o
reservatório através do orifício $a_2$. As vazões de saída dos tanques variam de
acordo com a mudança desses orifícios, disponibilizados em três diâmetros
diferentes pelo fabricante.

\Glossary{$T_1$}{Tanque superior}
\Glossary{$T_2$}{Tanque inferior}

Além dos diferentes orifícios de saída, o fabricante também disponibiliza um
conjunto de mangueiras, tornando possível a utilização dos dois orifícios de
entrada, bombeando água para os dois tanques simultaneamente. As dimensões de
cada um dos orifícios e os demais parâmetros do sistema podem ser visualizadas
na Tab. \ref{tab:dimensoes}.

\begin{table}[!htb]
\centering
\caption{Dimensões e parâmetros do sistema de tanques.}
\label{tab:dimensoes}
\vspace{0.25cm}
\begin{tabular}{|l|c|c|c|}
\hline
{\bf Nome} & {\bf Símbolo} & {\bf Valor} & {\bf Unidade}\\
\hline
\hline
\multicolumn{4}{|l|}{{\bf Bomba}}\\
\hline
\hline
Constante de fluxo & $K_m$ & 4,6 & (cm${}^3$/s)/V\\
\hline
Limites de Tensão & $V_{p_{\text{\tiny MAX/MIN}}}$ & $\pm 15$ & Volts\\
\hline
Orifício de entrada 1 & {\it Out 1} & 0,635 & cm\\
\hline
Orifício de entrada 2 & {\it Out 2} & 0,4763 & cm\\
\hline
\multicolumn{4}{|l|}{{\bf Tanque 1/Tanque 2}}\\
\hline
\hline
Altura & $H_1$/$H_2$ & 30 & cm\\
\hline
Diâmetro interno & -- & 4,445 & cm\\
\hline
Área de secção transversal & $A_1$/$A_2$ & 15,517916547 & cm${}^2$\\
\hline
Sensibilidade do sensor & -- & 5 & cm/V \\
\hline
\multicolumn{4}{|l|}{{\bf Orifícios de saída -- Diâmetros}}\\
\hline
\hline
Orifício pequeno & $a_{i_{\text{\tiny PEQ}}}$ & 0,3175 & cm\\
\hline
Orifício médio & $a_{i_{\text{\tiny MED}}}$ & 0,47625 & cm\\
\hline
Orifício grande & $a_{i_{\text{\tiny GDE}}}$ & 0,555625 & cm\\
\hline
\multicolumn{4}{|l|}{{\bf Orifícios de saída -- Áreas}}\\
\hline
\hline
Orifício pequeno & $a_{i_{\text{\tiny PEQ}}}$ & 0,079173044 & cm${}^2$\\
\hline
Orifício médio & $a_{i_{\text{\tiny MED}}}$ & 0,178139348 & cm${}^2$\\
\hline
Orifício grande & $a_{i_{\text{\tiny GDE}}}$ & 0,242467446 & cm${}^2$\\
\hline
\multicolumn{4}{|l|}{{\bf Sensores}}\\
\hline
\hline
{\it Range} de pressão & -- & 0 - 1 & PSI\\
\hline
{\it Range} de nível & -- & 0 - 30 & cm\\
\hline
Constante de sensibilidade & $K_s$ & $6,25\times$ & cm/V\\
\hline
\end{tabular}
\end{table}

Dentre as várias combinações possíveis obtidas a partir da mudança dos orifícios
de entrada e saída, as três configurações sugeridas pelo manual do fabricante
encontram-se representadas na Fig. \ref{fig:config_fab}. Cada uma dessas
configurações modifica a dinâmica do processo, permitindo que sejam projetados e
analisados diferentes tipos de controladores.

\begin{figure}[!htb]
\centering
\subfigure[Configuração 1.]
{
    \includegraphics[width=0.31\textwidth]{imgs/sistema/eps/config_fab_1}
    \label{fig:config_fab_1}
}
\subfigure[Configuração 2.]
{
    \includegraphics[width=0.31\textwidth]{imgs/sistema/eps/config_fab_2}
    \label{fig:config_fab_2}
}
\subfigure[Configuração 3.]
{
    \includegraphics[width=0.31\textwidth]{imgs/sistema/eps/config_fab_3}
    \label{fig:config_fab_3}
}
\caption{Configurações sugeridas pelo fabricante.}
\label{fig:config_fab}
\end{figure}

Na primeira configuração deseja-se controlar o nível de $T_1$ ($L_1$) através de
uma alimentação direta, não fazendo uso do segundo tanque. Na segunda
configuração deseja-se controlar o nível de $T_2$ ($L_2$) a partir de uma
alimentação indireta em $T_1$. Assim, $T_2$ é alimentado a partir da água que
escoa de $T_1$ pelo orifício $a_1$. Por fim, na terceira configuração, deseja-se
controlar o nível de $T_2$ a partir da alimentação indireta de $T_1$ e da
alimentação direta de $T_2$. Para isso, faz-se uso dos dois orifícios de
entrada.

\Glossary{$L_1$}{Nível do tanque superior}
\Glossary{$L_2$}{Nível do tanque inferior}

Em todos os casos pode-se perceber que o sistema se comporta como um sistema de
uma única entrada, que é a tensão de alimentação da bomba, e uma única saída
({\it Single Input and Single Output} -- SISO), que pode ser $L_1$ ou $L_2$,
dependendo da configuração.

\Glossary{SISO}{{\it Single Input and Single Output}}

Além dessas observações, deve-se destacar ainda que a planta em questão se trata
de um modelo desenvolvido para fins acadêmicos e que, por esse motivo, existem
alguns restrições quanto as interfaces e aos padrões de comunicação.

% ------------------------------------------------------------------------------
\subsection{Modelo matemático}

Como os dois tanques possuem mesma área de secção transversal ($A_1 = A_2$), a
dinâmica dos dois tanques será semelhante. Entretanto, encontrar um modelo
matemático que descreva adequadamente a dinâmica desses tanques não é algo tão
simples, visto que as equações gerais de movimento e energia que descrevem o
escoamento de fluidos são bastante complicadas \cite{dorf:2009}.

Assim sendo, é preciso que sejam feitas algumas hipóteses fundamentais.
Admite-se que a água no tanque é incompressível e que o escoamento é
não-viscoso, não-rotacional e regular. Cada uma dessas características serão
descritas a seguir baseadas na argumentação exposta em \citeasnoun{dorf:2009}.

Diz-se que um fluido é incompressível quando este possui uma massa específica
constante. Entretanto, sabe-se que todo fluido é compressível em certo grau e
que o fator de compressibilidade $k$ é uma medida de sua compressibilidade.
Quanto menor o valor de $k$, menor é a compressibilidade indicada para aquele
fluido. O ar, que é um fluido compressível, possui um fator de compressibilidade
$k_{\text{ar}} = 0,98\ \text{m}^2/\text{N}$, enquanto que a água tem um fator de
compressibilidade de $k_{\tiny \text{\tiny H}_2\text{\tiny O}} = 4,9 \times
10^{-10}\ \text{m}^2/\text{N} = 50 \times 10^{-6}\ \text{atm}^{-1}$. Em outras
palavras, um dado volume de água diminui em 50 milionésimos de seu volume
original para um aumento de uma atmosfera na pressão. Desse modo, a hipótese de
que a água é incompressível é valida para o sistema em questão.

Já a viscosidade de um fluido é dada pelo seu coeficiente de viscosidade $\mu\
(\text{N}\cdotp \text{s}/\text{m}^2)$. Quanto maior esse coeficiente, mais
viscoso é o fluido. Como exemplo, o coeficiente de viscosidade em condições
normais à 20\textdegree C para o ar é $\mu_{\text{ar}} = 0,178 \times 10^{-4}\
\text{N}\cdotp \text{s}/\text{m}^2$ enquanto que para a água
$\mu_{\tiny \text{\tiny H}_2\text{\tiny O}} = 1,054 \times 10^{-3}\
\text{N}\cdotp \text{s}/\text{m}^2$. Assim, a água é cerca de 60 vezes mais
viscosa que o ar.  Vale salientar que a viscosidade depende principalmente da
temperatura e não da pressão. Para efeitos de comparação, a água à 0\textdegree
C é 2 vezes mais viscosa que a água à 20\textdegree C. Com fluidos de baixa
viscosidade como o ar e a água, os efeitos do atrito são importantes apenas nas
camadas de fronteira e em uma fina camada adjacente à parede do reservatório e
da tubulação de saída.  Assim, pode-se desprezar a viscosidade no
desenvolvimento do modelo.

\Glossary{$\mu_{\text{ar}}$}{Coeficiente de viscosidade do ar}
\Glossary{$\mu_{\tiny \text{\tiny H}_2\text{\tiny O}}$}{Coeficiente de viscosidade da água}

Se cada elemento do fluido em cada ponto do escoamento não tem velocidade
angular com relação a esse ponto, o fluxo é denominado não-rotacional. Admita
que a água no tanque é não-rotacional. Logo, para um fluido não-viscoso, um
fluxo inicialmente não-rotacional permanece não-rotacional.

Por fim, o fluxo de água é dito regular se a velocidade em cada ponto é
constante com o tempo. Isso não implica necessariamente que a velocidade seja a
mesma em cada ponto, mas sim que em qualquer ponto a velocidade não mude com o
tempo. Condições de regime regular podem ser atingidas em velocidades baixas do
fluido. Admita então que há condições de fluxo regular. Observa-se entretanto
que se a área de abertura de saída fosse muito grande, o fluxo através do
reservatório não seria lento o suficiente para o estabelecimento das
condições de regime regular o que faria com que o modelo não conseguisse
predizer o fluxo do fluido de maneira exata.

Tendo esclarecido essas condições, para se obter o modelo matemático do fluido
dentro do reservatório emprega-se os princípios básicos da ciência e da
engenharia, como o princípio da conservação da massa. Assim, a massa de água em
qualquer instante de tempo é dada pela Eq. \ref{eq:conserv}.

\begin{equation}\label{eq:conserv}
m = \rhoagua\ AL
\end{equation}

\noindent em que $\rho_{\tiny \text{\tiny H}_2\text{\tiny O}}$ é a massa
específica da água, $A$ a área de secção transversal do reservatório e $L$ o
nível de água no reservatório. Tomando a derivada temporal de $m$ na Eq.
\ref{eq:conserv}, tem-se:

\begin{equation}
\dot{m} = \rhoagua\ A\dot{L}
\end{equation}

\noindent na qual utilizou-se o fato do fluido ser incompressível (ou seja,
$\dot{\rho} = 0$). Como a área de secção transversal não varia com o tempo, a
mudança de massa no reservatório é igual a massa que entra menos a massa que
deixa o tanque, logo:
 
\begin{equation}\label{eq:mudanca_massa}
\dot{m} = \rhoagua\ A\dot{L} = 
            Q_{\text{\tiny IN}} - 
\underbrace{\rhoagua\ a\upsilon_{\text{\tiny OUT}}}_
           {Q_{\text{\tiny OUT}}}
\end{equation}

\noindent em que $Q_{\text{\tiny IN}}$ é a vazão de entrada de massa em regime
permanente, $a$ é a área do orifício de saída e $\upsilon_{\text{\tiny OUT}}$ é
a velocidade de saída do fluido, que é uma função da altura da água. Da equação
de Bernoulli \cite{houghton:2002}, tem-se:

\begin{equation}
P_{\text{\tiny IN}} + 
\frac{1}{2}\rhoagua\ {\upsilon_{\text{\tiny IN}}}^2 +
\rhoagua\ gL
=
\frac{1}{2}\rhoagua\ {\upsilon_{\text{\tiny OUT}}}^2 +
P_{\text{\tiny OUT}}
\end{equation}

\noindent em que $\upsilon_{\text{\tiny IN}}$ é a velocidade da água na entrada
do reservatório e $P_{\text{\tiny IN}}$ e $P_{\text{\tiny OUT}}$ são as pressões
na entrada e na saída, respectivamente. Mas $P_{\text{\tiny IN}}$ e
$P_{\text{\tiny OUT}}$ são iguais à pressão atmosférica e a área de $a$ é
suficientemente pequena ($a \approx A/85$, considerando o orifício de saída
médio) para que a água escoe vagarosamente e a velocidade $\upsilon_{\text{\tiny
IN}}$ seja desprezível. Assim, a equação de Bernoulli fica reduzida a:

\begin{equation}\label{eq:bernoulli_red}
\upsilon_{\text{\tiny OUT}} = \sqrt{2gL}
\end{equation}

Além disso, segundo \citeasnoun{apkarian:1999}, a vazão de entrada
$Q_{\text{\tiny IN}}$ depende apenas da constante da bomba e da tensão à ela
aplicada, podendo ser positiva, quando a água é sugada do reservatório e
injetada no tanque, ou negativa quando a água é sugada do tanque e devolvida ao
reservatório. Assim:

\begin{equation}\label{eq:vazao_ent}
Q_{\text{\tiny IN}} = K_mV_p
\end{equation}

Substituindo então as Eqs. \ref{eq:bernoulli_red} e \ref{eq:vazao_ent} na Eq.
\ref{eq:mudanca_massa} e resolvendo para $\dot{L}$, tem-se:

\begin{equation}\label{eq:l_ponto}
\dot{L} = -\left[\frac{a}{A}\sqrt{2g}\right]\sqrt{L} + 
          \frac{1}{\rhoagua\ A}K_mV_p
\end{equation}

Considerando que a massa específica da água é $\rhoagua \approx 1,0$ à
20\textdegree C, então a Eq. \ref{eq:l_ponto} passa a ser:

\begin{equation}\label{eq:l_ponto_final}
\dot{L} = -\left[\frac{a}{A}\sqrt{2g}\right]\sqrt{L} + 
          \frac{K_m}{A}V_p
\end{equation}

Assim, as duas únicas variáveis do modelo serão o nível $L$ do tanque e a tensão
$V_p$ aplicada à bomba. Perceba que essa é uma equação diferencial ordinária
não-linear.

% ------------------------------------------------------------------------------
\subsection{Modificações do modelo}
Observa-se que Eq. \ref{eq:l_ponto_final} representa adequadamente a dinâmica do
tanque superior, contudo, a dinâmica do tanque inferior age um pouco diferente.
Em primeiro lugar, dependendo da configuração escolhida $T_2$ poderá ou não
receber uma alimentação direta. Considerando, por exemplo, a primeira
configuração sugerida pelo manual do fabricante (Fig. \ref{fig:config_fab_1}), a
dinâmica de $T_2$ irá depender apenas da vazão de água que escoa de $T_1$ e da
vazão de água que retorna ao reservatório. Assim sendo, a dinâmica dos dois
tanques pode ser representada pelas Eqs. \ref{eq:l1_ponto} e \ref{eq:l2_ponto}:

\begin{eqnarray}
\dot{L_1} & = & \frac{K_m}{A}V_p -
                \left[\frac{a_1}{A}\sqrt{2g}\right]\sqrt{L_1}
                \label{eq:l1_ponto}\\
\dot{L_2} & = & \left[\frac{a_1}{A}\sqrt{2g}\right]\sqrt{L_1} -
                \left[\frac{a_2}{A}\sqrt{2g}\right]\sqrt{L_2}
                \label{eq:l2_ponto}
\end{eqnarray}

\noindent em que $a_1$ representa o orifício de saída de $T_1$, $a_2$ o orifício
de saída de $T_2$, $L_1$ o nível de água em $T_1$ e $L_2$ o nível e água em
$T_2$. Perceba que não há necessidade em se discriminar a área de secção
transversão através de um subíndice, pois $A_1 = A_2 = A$.

Com o intuito de deixar o sistema proposto com um caráter mais genérico e
possibilitar estudos futuros com relação à tolerância a falhas, optou-se por
modificar o sistema de tanques original introduzindo uma outra bomba com as
mesmas características da primeira. Dessa forma, pôde-se obter novas
configurações, dentre as quais destaca-se aquelas expostas pela Fig.
\ref{fig:novas_config}.

\begin{figure}[htb]
\centering
\subfigure[Nova configuração 1.]
{
    \includegraphics[width=0.45\textwidth]{imgs/sistema/eps/nova_config_1}
    \label{fig:nova_config_1}
}
\subfigure[Nova configuração 2.]
{
    \includegraphics[width=0.45\textwidth]{imgs/sistema/eps/nova_config_2}
    \label{fig:nova_config_2}
}
\caption{Novas configurações sugeridas após a modificação do modelo.}
\label{fig:novas_config}
\end{figure}

Na configuração exposta pela Fig. \ref{fig:nova_config_1}, pode-se controlar o
nível dos dois tanques de maneira individual através das duas bombas de água.
Para isso, pode-se implementar dois controladores cada um com sua referência e a
leitura do respectivo sensor ou um único controlador que receberá as duas
referências e as leituras dos dois sensores.

Já na configuração exposta pela Fig. \ref{fig:nova_config_2}, a segunda bomba
está sendo utilizada para garantir que o processo continue funcionando
normalmente quando a primeira bomba vier a falhar. Ou seja, possui-se dois
atuadores com um deles em {\it standby}.  Ademais, ressalta-se que essa última
configuração pode ser adaptada para qualquer uma das três anteriores sugeridas
pelo fabricante.

Percebe-se que no primeiro caso (Fig. \ref{fig:nova_config_1}) o sistema deixa
de ser SISO e passa a ter múltiplas entradas e múltiplas saídas ({\it Multiple
Input and Multiple Output} -- MIMO). Por esse motivo, esse sistema será o
utilizado como modelo de estudo de caso no trabalho. A única modificação
existente nas equações que regem a dinâmica do modelo é a introdução de uma nova
variável na equação do segundo tanque em virtude da adição da segunda bomba.
Assim, as equações finais do modelo de estudo de caso serão:

\begin{eqnarray}
\dot{L_1} & = & \frac{K_m}{A}V_{p_{\tiny 1}} -
                \left[\frac{a_1}{A}\sqrt{2g}\right]\sqrt{L_1}
                \label{eq:l1_ponto}\\
\dot{L_2} & = & \frac{K_m}{A}V_{p_{\tiny 2}} +
                \left[\frac{a_1}{A}\sqrt{2g}\right]\sqrt{L_1} -
                \left[\frac{a_2}{A}\sqrt{2g}\right]\sqrt{L_2}
                \label{eq:l2_ponto}
\end{eqnarray}

\noindent em que $V_{p_{\tiny 1}}$ se refere à tensão aplicada na Bomba 1
($B_1$) e $V_{p_{\tiny 2}}$ à tensão aplicada na Bomba 2 ($B_2$).

\Glossary{$B_i$}{Bomba $i$}

% ------------------------------------------------------------------------------
\section{Limitações do processo}\label{sec:limitacoes}
Conforme dito anteriormente, a planta do estudo de caso foi desenvolvida para
fins acadêmicos e possui algumas limitações com relação as interfaces e aos
padrões de comunicação. Por causa dessas limitações a planta é normalmente
controlada por um sistema desenvolvido computacionalmente em que a comunicação
se dá através de um barramento ISA ({\it Industry Standard Architecture}). Tal
sistema deve calcular as ações de controle proporcional, integral e derivativa e
produzir um sinal de controle em Volts que será enviado aos atuadores.

\Glossary{ISA}{{\it Industry Standard Architecture}}

Entretanto, devido aos baixos níveis de tensão intrínsecos à esse tipo de
barramento, faz-se necessário utilizar um amplificador, também fornecido pela
Quanser\reg, com um fator de amplificação de cinco vezes. Assim, para que a
bomba não venha a queimar, os sistemas de controle devem implementar uma rotina
de segurança que garanta que o sinal de controle não supere os limites de $\pm
3$ Volts. A representação esquemática do funcionamento do sistema como um todo
está representada na Fig. \ref{fig:func_sistema}.

\begin{figure}[htb]
\centering
    \includegraphics[width=0.8\textwidth]{imgs/sistema/eps/func_sistema}
    \caption{Diagrama esquemático de funcionamento do sistema proposto.}
    \label{fig:func_sistema}
\end{figure}

A partir dessa representação esquemática, percebe-se facilmente que as únicas
variáveis disponíveis são os níveis dos tanques ($L_1$ e $L_2$ e as tensões das
bombas ($V_{p_{\tiny 1}}$ e $V_{p_{\tiny 2}}$).

Além das limitações físicas relacionadas aos sinais enviados ou recebidos pelo
processo, destaca-se ainda o fato de se tratar de uma planta real em que todos
os dispositivos físicos e mecânicos estão sujeitos a deteriorações relacionadas
ao tempo de uso. Assim sendo, não se considera uma boa prática estimular ou
induzir falhas no sistema real. Logo, todas as falhas a serem analisadas serão
induzidas através do modelo matemático simulado em um sistema computacional.

% ------------------------------------------------------------------------------
\section{Simulações do sistema e das falhas}
Considerando os fatores expostos ao final da seção \ref{sec:limitacoes}, o
sistema de tanques será simulado a partir das Eqs. \ref{eq:l1_ponto} e
\ref{eq:l2_ponto}, utilizando o método de Runge-Kutta de 4\textordfeminine\
ordem (RK4).

\Glossary{RK4}{Método de Runge-Kutta de 4\textordfeminine\ ordem}

De maneira resumida, pode-se dizer que o RK4 faz parte de uma família de métodos
interativos para a aproximação numérica de soluções de equações diferenciais
ordinárias. O funcionamento do método pode esclarecido conforme explicação a
seguir. 

Seja um problema de valor inicial dado por:

\begin{equation}\label{eq:}
y' = f(t,y) \qquad y(t_0) = y_0
\end{equation}

Então o método RK4 para este problema é dado pelas seguintes equações:

\begin{eqnarray}
y_{n+1} & = & y_n + \frac{h}{6}\left(k_1 + 2k_2 + 2k_3 + k_4\right)\\
t_{n+1} & = & t_n + h
\end{eqnarray}

\noindent em que $y_{n+1}$ é a aproximação por RK4 de $y(t_{n + 1})$, e:

\begin{eqnarray}
k_1 & = & f\left(t_n,y_n\right)\\
k_2 & = & f\left(t_n+\frac{h}{2},y_n+\frac{h}{2}k_1\right)\\
k_3 & = & f\left(t_n+\frac{h}{2},y_n+\frac{h}{2}k_2\right)\\
k_4 & = & f\left(t_n+h,y_n+hk_3\right)
\end{eqnarray}

Assim, o próximo valor ($y_{n+1}$) é determinado a partir do valor atual ($y_n$)
somado com o produto do tamanho do intervalo ($h$) e uma inclinação estimada,
obtida a partir da média ponderada das inclinações $k_i$. Percebe-se ainda que a
média ponderada dá um maior peso para as inclinações no ponto médio.

\begin{comment}
\begin{itemize}
    \item $k_1$ é a inclinação no início do intervalo;
    \item $k_2$ é a inclinação no ponto médio do intervalo, usando $k_1$ para
determinar o valor de $y$ no ponto $t_n + h/2$ através do método de Euler;
    \item $k_3$ é novamente a inclinação no ponto médio do intervalo, usando
entretanto a inclinação $k_2$ para determinar o valor de $y$;
    \item $k_4$ é a inclinação no final do intervalo, com seu valor de $y$
determinado a partir de $k_3$.
\end{itemize}
\end{comment}

O método de RK4 permite que sejam determinados os valores de $L_1$ e $L_2$ para
cada instante da simulação e, consequentemente, que a dinâmica do processo seja
observada. As falhas induzidas no processo serão então computadas a partir de
alterações feitas sobre os valores de $L_1$ e $L_2$ obtidos. Dependendo do tipo
de falha, a alteração pode ocorrer antes, durante ou após a execução do método
de RK4.

% ------------------------------------------------------------------------------
\subsection{Falhas simuladas}
Dentre as diversas falhas que podem ser simuladas, algumas foram selecionadas e
classificadas. Na Tab. \ref{tab:selecao_falhas} são mostrados alguns exemplos de
falhas que podem ocorrer no sistema de tanques, enquanto que nas Tabs.
\ref{tab:grupos_falhas} e \ref{tab:classificacao_falhas} as falhas são agrupadas
e classificadas de acordo com suas similaridades. As falhas a serem testadas no
sistema são aquelas exibidas pela Tab. \ref{tab:classificacao_falhas}.

\begin{table}[htb]
\centering
\caption{Exemplos de falhas que podem ocorrer no sistema de tanques.}
\label{tab:selecao_falhas}
\vspace{0.25cm}
\begin{tabular}{|c|c|c|}
\hline
{\bf Sensores} & {\bf Atuadores} & {\bf Estruturais}\\
\hline
\hline
Erro de leitura & Erro de escrita & Erro de transmissão\\
\hline
Descalibramento & Erro de leitura & Perda de comunicação\\
\hline
Sensibilidade à ruído & Sensibilidade à ruído & Sensibilidade à ruído\\
\hline
Queima do sensor & Queima do atuador & Queima do transmissor\\
\hline
-- & Atraso de transporte & Atraso de propagação\\
\hline
\end{tabular}
\end{table}

\begin{table}[htb]
\centering
\caption{Grupos de falhas.}
\label{tab:grupos_falhas}
\vspace{0.25cm}
\begin{tabular}{|c|c|c|}
\hline
{\bf Grupo} & {\bf Tipo de falha} & {\bf Sigla}\\
\hline
\hline
0 & Não há falhas & SF\\
\hline
1 & Falha do sensor & FSe\\
\hline
2 & Falha do atuador & FA\\
\hline
\multirow{2}{*}{3} & 
Falha estrutural ou & 
\multirow{2}{*}{FSi}\\
&
Falha do sistema & 
\\
\hline
\end{tabular}
\end{table}

\begin{table}[htb]
\centering
\caption{Classificação das falhas selecionadas.}
\label{tab:classificacao_falhas}
\vspace{0.25cm}
\begin{tabular}{|c|c|c|c|c|}
\hline
{\bf Grupo} & {\bf Classe} & {\bf Denominação} & {\bf Variante} & {\bf Sigla}\\
\hline
1 & 1 & Descalibramento & Ganho & FSeDG\\
\hline
1 & 1 & Descalibramento & Nível DC ({\it offset}) & FSeDO\\
\hline
1 & 2 & Sensibilidade & Ruído & FSeSR\\
\hline
1 & 3 & Queima & -- & FSeQ\\
\hline
\hline
2 & 1 & Descalibramento & Ganho & FADG\\
\hline
2 & 1 & Descalibramento & Nível DC ({\it offset}) & FADO\\
\hline
2 & 2 & Sensibilidade & Ruído & FASR\\
\hline
2 & 3 & Variação & Constante da bomba ($K_m$) & FAVK\\
\hline
2 & 4 & Queima & -- & FAQ\\
\hline
\hline
3 & 1 & Entupimento & Orifício de saída & FSiEOS\\
\hline
3 & 2 & Variação & Ganho do módulo de potência & FSiVrGMP\\
\hline
3 & 2 & Variação & Orifício de saída & FSiVrOS\\
\hline
3 & 3 & Vazamento & Tanque & FSiVzT\\
\hline
\end{tabular}
\end{table}

As siglas expostas nessas tabelas foram introduzidas com o intuito de facilitar
tanto o processo automático\footnote{O processo de treinamento e validação se
deu através de {\it scripts} (rotinas) do {\it software} matemático MATLAB\reg.}
de treinamento e validação da estrutura neural de DDF, quanto a referenciação
textual.

% cada uma foi simulada de uma maneira
% diferente fazendo alteracoes sobre os valores finais calculados pelo sistema
% (sensor, controlador... olhar arquivo simulacao.cpp)

% ------------------------------------------------------------------------------
\section{Estruturas neurais escolhidas}
Cada uma das falhas escolhidas, exibidas na Tab.
\ref{tab:classificacao_falhas}, pode acontecer de maneira isolada, ou seja, em
um dos tanques, ou de maneira conjunta, atuando simultaneamente na dinâmica dos
dois tanques. Assim sendo, a estrutura neural escolhida deverá ser capaz de
identificar que tipo de falha está acontecendo, e em que tanque(s) esta estará
agindo.

% ------------------------------------------------------------------------------
\section{Esquemas de identificação}

% ------------------------------------------------------------------------------
\subsection{Proposta 1 -- Identificação global}

% ------------------------------------------------------------------------------
\subsection{Proposta 2 -- Identificação individual}

% ------------------------------------------------------------------------------
\section{Esquemas de detecção}

% ------------------------------------------------------------------------------
\subsection{Proposta 1 -- Comitê de especialistas}

% ------------------------------------------------------------------------------
\subsection{Proposta 2 -- Detecção global}
